dnl
dnl Process this file with autoconf to produce a configure script
dnl

AC_PREREQ(2.13)
AC_INIT(build/rules.mk.in)

AC_CONFIG_HEADER(include/apu_config.h)
AC_CONFIG_AUX_DIR(build)

AC_PROG_CC
AC_CHECK_PROG(RM, rm, rm)

dnl
dnl 1. Find the APR includes directory and (possibly) the source (base) dir.
dnl 2. Determine what DBM backend type to use.
dnl
APU_FIND_APR
APU_CHECK_DBM

dnl
dnl compute the top directory of the build
dnl
top_builddir="`cd $srcdir ; pwd`"
AC_SUBST(top_builddir)

dnl
dnl prep libtool
dnl
echo "performing libtool configuration..."
AC_PROG_LIBTOOL

dnl
dnl set up the compilation flags and stuff
dnl
INCLUDES="-I$APR_INCLUDES -I\$(top_builddir)/include"

CFLAGS="$CFLAGS $INCLUDES"


AC_OUTPUT([
	Makefile
	build/Makefile
	build/rules.mk
	include/apu_private.h
	src/Makefile
	src/buckets/Makefile
	src/crypto/Makefile
	src/dbm/Makefile
	src/dbm/sdbm/Makefile
	src/encoding/Makefile
	src/hooks/Makefile
	src/uri/Makefile
	src/xml/Makefile
	test/Makefile
	])
